在做数据筛选时，有时会遇到比较复杂的逻辑，但是我们知道了筛选原理就能灵活运动相关操作筛选想要的数据。在本例中，我们将完成除了筛选直接条件的数据外，还要筛选数据上下行数据。

## 数据需求

```python
import pandas as pd

df = pd.DataFrame({'a': [*'abcdefghij'], 'b': [*'NYYNNNNYNN']})
df
'''
   a  b
0  a  N
1  b  Y
2  c  Y
3  d  N
4  e  N
5  f  N
6  g  N
7  h  Y
8  i  N
9  j  N
'''
df[(df.b == 'Y') | (df.b.shift(1) == 'Y') | (df.b.shift(-1) == 'Y')]
```

b 列 Y 代码数据有异常，但实际上 Y 前一行和后一行均为有异常的数据。

需求为筛选出有异常的数据。

## 思路

筛选数据最简单的办法是 df[...] 的形式，方括号里是一个布尔序列，为 True 的表示此行匹配。

本例子中，我们可以用 df.b == 'Y' 来筛选出直接为异常的数据，要包括上行下行，可以使用shift()来移位匹配，最后将这些条件用或逻辑连接。

## 代码

```pyhton
df[(df.b == 'Y') | (df.b.shift(1) == 'Y') | (df.b.shift(-1) == 'Y')]
```

